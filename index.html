<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FenixGroup">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Fenix Group Pro</title>

    <link rel="apple-touch-icon" href="https://via.placeholder.com/180/059669/ffffff?text=FG">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #059669; --bg: #f8fafc; --card: #ffffff;
            --text: #1e293b; --sub: #64748b; --border: #e2e8f0;
        }
        body { 
            font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text);
            margin: 0; padding-top: env(safe-area-inset-top); -webkit-user-select: none;
        }
        
        /* Header Profesional */
        header {
            background: var(--card); padding: 1rem 1.5rem; border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
        }
        .brand { display: flex; align-items: center; gap: 10px; }
        .logo { width: 40px; height: 40px; background: var(--primary); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 800; }
        
        /* Dashboard */
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 1.5rem; }
        .stat-card { background: var(--card); padding: 12px; border-radius: 16px; border: 1px solid var(--border); text-align: center; }
        .stat-label { font-size: 0.65rem; color: var(--sub); font-weight: 600; text-transform: uppercase; }
        .stat-val { font-size: 1.1rem; font-weight: 800; display: block; margin-top: 4px; }

        .container { padding: 0 1.5rem 100px 1.5rem; }
        .search-box { width: 100%; padding: 14px; border-radius: 14px; border: 1px solid var(--border); font-size: 1rem; margin-bottom: 20px; box-sizing: border-box; }

        /* Tarjetas de Registro */
        .pig-card { 
            background: var(--card); border-radius: 20px; padding: 16px; margin-bottom: 12px;
            border: 1px solid var(--border); box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        .card-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .tag { padding: 4px 8px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; }
        .net-weight { font-size: 0.75rem; color: var(--primary); font-weight: 700; background: #f0fdf4; padding: 4px 8px; border-radius: 6px; }

        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: var(--card); z-index: 1000; padding: calc(2rem + env(safe-area-inset-top)) 1.5rem; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.75rem; font-weight: 700; color: var(--sub); margin-bottom: 6px; }
        input, select { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid var(--border); font-size: 1rem; box-sizing: border-box; background: #f1f5f9; }
        
        .btn-main { background: var(--text); color: white; width: 100%; padding: 16px; border-radius: 16px; border: none; font-weight: 700; font-size: 1rem; margin-top: 10px; }
        .fab { position: fixed; bottom: calc(30px + env(safe-area-inset-bottom)); right: 20px; width: 64px; height: 64px; background: var(--primary); color: white; border-radius: 20px; border: none; font-size: 32px; box-shadow: 0 8px 20px rgba(5,150,105,0.3); }
    </style>
</head>
<body>

<header>
    <div class="brand">
        <div class="logo">F</div>
        <div>
            <div style="font-weight: 800; font-size: 1rem;">Fenix Group ðŸ”¥</div>
            <div style="font-size: 0.65rem; color: var(--primary); font-weight: 700;">SISTEMA PROFESIONAL</div>
        </div>
    </div>
    <div id="clock" style="font-weight: 700; font-size: 0.8rem; color: var(--sub);"></div>
</header>

<div class="stats">
    <div class="stat-card"><span class="stat-label">Total</span><span class="stat-val" id="count">0</span></div>
    <div class="stat-card"><span class="stat-label">Peso Prom.</span><span class="stat-val" id="avg">0</span></div>
    <div class="stat-card"><span class="stat-label">Ganancia</span><span class="stat-val" id="gain">+0.0</span></div>
</div>

<div class="container">
    <input type="text" id="search" class="search-box" placeholder="ðŸ” Buscar por ID..." onkeyup="render()">
    <div id="list"></div>
</div>

<button class="fab" onclick="openModal()">+</button>

<div id="modal" class="modal">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
        <h2 style="margin:0">Registro de Pesaje</h2>
        <button onclick="closeModal()" style="border:none; background:#f1f5f9; padding:8px 15px; border-radius:10px; font-weight:800;">CERRAR</button>
    </div>
    
    <div class="input-group">
        <label>IDENTIFICACIÃ“N DEL CERDO</label>
        <input type="text" id="p_id" placeholder="Ej: C-204">
    </div>
    
    <div class="input-group">
        <label>PESO BRUTO (KG)</label>
        <input type="number" id="p_weight" placeholder="0.00">
    </div>

    <div class="input-group">
        <label>ESTADO NUTRICIONAL</label>
        <select id="p_status">
            <option>Ã“ptimo</option>
            <option>En ObservaciÃ³n</option>
            <option>CrÃ­tico</option>
        </select>
    </div>

    <button class="btn-main" onclick="saveData()">GUARDAR REGISTRO</button>
</div>

<script>
    let data = JSON.parse(localStorage.getItem('fenix_pro_db')) || [];

    function openModal() { document.getElementById('modal').style.display = 'block'; }
    function closeModal() { document.getElementById('modal').style.display = 'none'; }

    function saveData() {
        const id = document.getElementById('p_id').value;
        const weight = parseFloat(document.getElementById('p_weight').value);
        const status = document.getElementById('p_status').value;

        if(!id || isNaN(weight)) return alert("Datos incompletos");

        // CÃ¡lculo de Peso Neto (Descontando 3% de merma estimada)
        const net = (weight * 0.97).toFixed(2);
        
        const now = new Date();
        const entry = {
            id, weight, net, status,
            fullDate: now.toLocaleDateString(),
            time: now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
            timestamp: now.getTime()
        };

        data.unshift(entry);
        localStorage.setItem('fenix_pro_db', JSON.stringify(data));
        
        document.getElementById('p_id').value = '';
        document.getElementById('p_weight').value = '';
        closeModal();
        render();
    }

    function render() {
        const q = document.getElementById('search').value.toLowerCase();
        const list = document.getElementById('list');
        const filtered = data.filter(p => p.id.toLowerCase().includes(q));

        list.innerHTML = filtered.map((p, i) => `
            <div class="pig-card">
                <div class="card-header">
                    <span style="font-weight:800; font-size:1.1rem;">#${p.id}</span>
                    <span class="tag" style="background:${p.status==='Ã“ptimo'?'#ecfdf5':'#fff7ed'}; color:${p.status==='Ã“ptimo'?'#065f46':'#9a3412'}">${p.status}</span>
                </div>
                <div style="display:flex; justify-content:space-between; align-items:flex-end;">
                    <div>
                        <div style="font-size:0.85rem; color:var(--sub);">Bruto: <b>${p.weight} kg</b></div>
                        <div class="net-weight">Neto Est.: ${p.net} kg</div>
                    </div>
                    <div style="text-align:right; font-size:0.7rem; color:var(--sub);">
                        ${p.fullDate} <br> <b>${p.time}</b>
                    </div>
                </div>
            </div>
        `).join('');

        document.getElementById('count').innerText = data.length;
        const avg = data.length ? (data.reduce((acc, p) => acc + p.weight, 0) / data.length).toFixed(1) : 0;
        document.getElementById('avg').innerText = avg + "kg";
    }

    setInterval(() => {
        document.getElementById('clock').innerText = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
    }, 1000);

    window.onload = render;
</script>
</body>
</html>
